<!-- snippets/collection__subtags.liquid -->
{% comment %} 
  Secondary navigation for collection pages. Use tags for quick filtering.

  Globals:
  - layout_horizontal: {string} Class string to set horizontal margin.

  Usage:
    {% render 'collection__subtags' %}

  Recommendations:
    - Use this snippet on collection templates.
    - These links are populated using metafields. 
{% endcomment %}

{% assign raw_sub_tags = collection.metafields.custom.subtags %}
{% if raw_sub_tags != blank %}
  <section
    class="
      {{ section.settings.color_scheme }}
    ">
    <nav 
      class="
        flex flex-wrap py-2 border--b-width
        {{ section.settings.color_border }}
        {% if section.settings.enable_margin %}
          {{ settings.x_margin }}
        {% else %}
          window--full
        {% endif %}
      ">
      <div class="relative w-full window--max-width">
        <div class="inline-flex gap-1 p-1 overflow-x-auto color__bg-shade-2 border__button--radius whitespace-nowrap scroll-smooth snap-x">
          <div class="flex justify-center flex-none snap-start">
            <a href="{{ collection.url }}"
              class="py-2 px-4 type--smaller no-underline
              {% if current_tags == blank %}!color__bg-body{% endif %}">
              {{ 'labels.all' | t }}
            </a>
          </div>
          {% for item in raw_sub_tags.value %}
            <div class="flex justify-center flex-none snap-start">
              <a href="{{ collection.url }}/{{ item | split: ',' | last | handle }}"
                class="py-2 px-4 type--smaller no-underline
                {% assign handleized_current_tags = current_tags | handleize %}
                {% assign handleized_item = item | handleize %}
                {% if handleized_current_tags contains handleized_item %}
                  !color__bg-body
                {% endif %}">
                {{ item | split: ',' | first }}
              </a>
            </div>
          {% endfor %}
        </div>
      </div>
    </nav> 
  </section>
{% endif %}
