{% comment %}
  This file is a Shopify Liquid snippet for rendering a 3D model viewer with zoom and view-in-space functionalities. It is designed to enhance product pages by allowing users to interact with 3D models of products.

  Accepts:
  - media: {Object} Liquid object containing video details like host platform and other attributes.
  - ratio_class: {string} CSS class to control the aspect ratio of the video container.
  - model_viewer_id: {string} Unique identifier for the model viewer.

  Usage:
    {% render 'gallery__model',
      media: product.media.first,
      ratio_class: 'aspect-ratio-16-9',
      model_viewer_id: 'model-viewer'
    %}

  Recommendations:
  - Utilize this snippet in product detail pages to provide an interactive 3D view of products.
  - Ensure that the 'model_viewer_id' is unique per instance to avoid conflicts in the DOM.
{% endcomment %}

{% liquid
  assign model_viewer_id = model_viewer_id | handle
%}

<div
  class="group/model h-full w-full"
  x-data="
    {
      modelViewer: null,
      init() {
        this.modelViewer = document.getElementById('{{ model_viewer_id }}');
      },
      zoomIn() {
        this.modelViewer.removeAttribute('disable-zoom');
        this.modelViewer.zoom(4.0);
      },
      zoomOut() {
        this.modelViewer.removeAttribute('disable-zoom');
        this.modelViewer.zoom(-4.0);
      }
    }
  "
  x-init="init()"
>
  {% comment %} Model viewer {% endcomment %}
  <div
    class="
      h-full overflow-hidden object-cover
      {{ ratio_class }}
    "
  >
    <div
      class="flex h-full items-center"
      data-media-id="{{ media.id }}"
    >
      {{ media | model_viewer_tag: id: model_viewer_id, class: 'w-full h-full', disable-zoom: true }}
    </div>
  </div>

  {% comment %} Badge and controls {% endcomment %}
  <div class="absolute left-2 top-2 z-10 flex flex-col gap-2">
    <div class="color__bg-overlay-1 flex p-2">
      {% render 'component__icon', icon: '3d', size: '16' %}
    </div>
    <button
      class="btn btn--plain btn--smaller animation-300 !p-2 hover:opacity-100 group-hover/model:opacity-100 md:opacity-0"
      title="{{ 'actions.zoom_in' | t }}"
      type="button"
      @click="zoomIn"
    >
      {% render 'component__icon', icon: 'plus', size: '16', class: '' %}
    </button>
    <button
      class="btn btn--plain btn--smaller animation-300 !p-2 hover:opacity-100 group-hover/model:opacity-100 md:opacity-0"
      title="{{ 'actions.zoom_out' | t }}"
      type="button"
      @click="zoomOut"
    >
      {% render 'component__icon', icon: 'minus', size: '16', class: '' %}
    </button>
  </div>

  {% comment %} View in space {% endcomment %}
  <div
    class="absolute bottom-2 left-auto right-auto z-10 w-full"
  >
    <button
      class="btn btn--smaller btn--secondary"
      type="button"
      data-shopify-xr
      data-shopify-model3d-id="{{ media.id }}"
      data-shopify-title="{{ product.title | escape }}"
      data-shopify-xr-hidden
    >
      {{ 'actions.view_in_space' | t }}
    </button>
  </div>
</div>
