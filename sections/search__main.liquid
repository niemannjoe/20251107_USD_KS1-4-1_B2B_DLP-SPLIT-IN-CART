<!-- sections/search__main.liquid -->
{% comment %}
  Grid of search results for search template.

  Globals:
  - layout_horizontal: {string} Class string to set horizontal margin.

  Possible enhancements:
  - Add setting to limit search results to product, blog, or collections.
{% endcomment %}

<section
  id="{{ section.id }}"
  class="
    js-paginationTop
    {{ section.settings.color_scheme }}
  "
>
  {% comment %} Filters {% endcomment %}
  <div
    class="sticky top-0 z-20 flex flex-col"
    {% if settings.header_position == 'sticky' %}
      :style="
        {
          top: header_group_height + 'px'
        }
      "
    {% endif %}
  >
    {% if section.settings.filter_placement == 'top' %}
      {% render 'component__filter-bar', results: search %}
    {% endif %}
  </div>

  {% comment %} Filtering and results {% endcomment %}
  <div
    class="
      flex flex-wrap
      {% if section.settings.enable_margin %}
        {{ settings.x_margin }}
      {% else %}
        widow--full
      {% endif %}
    "
  >
    {% comment %} Filters {% endcomment %}
    {% if section.settings.filter_placement == 'side' %}
      <div
        class="sticky top-0 z-20 w-full md:z-0 md:w-1/4"
        {% if settings.header_position == 'sticky' %}
          :style="
            {
              top: header_group_height + 'px'
            }
          "
        {% endif %}
      >
        {% render 'component__filter-stack', results: search %}
      </div>
    {% endif %}

    {% comment %} Grid {% endcomment %}
    <div
      class="
        w-full
        {% if section.settings.filter_placement == 'side' %}
          md:w-3/4
        {% endif %}
      "
    >
      {% paginate search.results by section.settings.items_per_page %}
        {% comment %} Results {% endcomment %}
        <section
          id="js-results"
          class="
            animation-500 grid
            md:grid-cols-{{ section.settings.layout_row_desktop }}
            grid-cols-{{ section.settings.layout_row_mobile }}
          "
          :class="
            {
              'opacity-25' : pagination_loading
            }
          "
          style="
            column-gap: {{ settings.gap_size }}px;
            row-gap: {{ settings.gap_size | times: 3 }}px;
            padding-top:{{ section.settings.spacing_top }}px;
            padding-bottom:{{ section.settings.spacing_bottom }}px;
            {% unless section.settings.enable_margin %}
              padding-left: {{ settings.gap_size }}px;
              padding-right: {{ settings.gap_size }}px;
            {% endunless %}
          "
        >
          {% for item in search.results %}
            {% render 'component__search-item', item: item %}
          {% endfor %}
        </section>

        {% comment %} Pagination {% endcomment %}
        {% if search.results_count == 0 %}
          <section class="py-4 text-center">
            <span>{{ 'info.search_no_results' | t }}</span>
          </section>
        {% else %}
          {% render 'component__pagination', paginate: paginate %}
        {% endif %}
      {% endpaginate %}
    </div>
  </div>
</section>

{% schema %}
{
  "name": "t:sections.search_main.name",
  "settings": [
    {
      "type": "header",
      "content": "t:general.headers.spacing.content"
    },
    {
      "type": "range",
      "id": "spacing_top",
      "min": 0,
      "max": 300,
      "step": 10,
      "unit": "px",
      "label": "t:general.settings.top_spacing.label",
      "default": 100
    },
    {
      "type": "range",
      "id": "spacing_bottom",
      "min": 0,
      "max": 300,
      "step": 10,
      "unit": "px",
      "label": "t:general.settings.bottom_spacing.label",
      "default": 100
    },
    {
      "type": "header",
      "content": "t:general.headers.color.content"
    },
    {
      "type": "select",
      "id": "color_scheme",
      "label": "t:general.settings.color_scheme.label",
      "options": [
        {
          "value": "color__bg-body color__text",
          "label": "t:general.settings.color_scheme.body.label"
        },
        {
          "value": "color__bg-neutral color__neutral",
          "label": "t:general.settings.color_scheme.neutral.label"
        },
        {
          "value": "color__bg-overlay-1 color__text",
          "label": "t:general.settings.color_scheme.accent_1.label"
        },
        {
          "value": "color__bg-overlay-2 color__text",
          "label": "t:general.settings.color_scheme.accent_2.label"
        },
        {
          "value": "color__bg-overlay-3 color__text",
          "label": "t:general.settings.color_scheme.accent_3.label"
        },
        {
          "value": "color__bg-shade-1 color__text",
          "label": "t:general.settings.color_scheme.shade_1.label"
        },
        {
          "value": "color__bg-shade-2 color__text",
          "label": "t:general.settings.color_scheme.shade_2.label"
        },
        {
          "value": "color__bg-shade-3 color__text",
          "label": "t:general.settings.color_scheme.shade_3.label"
        },
        {
          "value": "color__bg-primary color__primary",
          "label": "t:general.settings.color_scheme.primary.label"
        },
        {
          "value": "color__bg-secondary color__secondary",
          "label": "t:general.settings.color_scheme.secondary.label"
        },
        {
          "value": "color__bg-tertiary color__tertiary",
          "label": "t:general.settings.color_scheme.tertiary.label"
        }
      ],
      "default": "color__bg-body color__text"
    },
    {
      "type": "select",
      "id": "color_border",
      "label": "t:general.settings.color_border.label",
      "options": [
        {
          "value": "color__border-divider-1",
          "label": "t:general.settings.color_border.subtle.label"
        },
        {
          "value": "color__border-selected-1",
          "label": "t:general.settings.color_border.strong.label"
        },
        {
          "value": "!color__border-transparent",
          "label": "t:general.settings.color_border.none.label"
        }
      ],
      "default": "color__border-divider-1"
    },
    {
      "type": "select",
      "id": "color_button",
      "label": "t:general.settings.color_button.label",
      "options": [
        {
          "value": "btn",
          "label": "t:general.settings.color_button.primary.label"
        },
        {
          "value": "btn btn--secondary",
          "label": "t:general.settings.color_button.secondary.label"
        },
        {
          "value": "btn btn--tertiary",
          "label": "t:general.settings.color_button.tertiary.label"
        },
        {
          "value": "btn btn--neutral",
          "label": "t:general.settings.color_button.neutral.label"
        },
        {
          "value": "btn btn--plain",
          "label": "t:general.settings.color_button.plain.label"
        },
        {
          "value": "btn btn--outline",
          "label": "t:general.settings.color_button.outline.label"
        },
        {
          "value": "btn btn--outline-alt",
          "label": "t:general.settings.color_button.inverted_outline.label"
        },
        {
          "value": "btn btn--minimal",
          "label": "t:general.settings.color_button.link.label"
        },
        {
          "value": "btn btn--minimal-alt",
          "label": "t:general.settings.color_button.inverted_link.label"
        }
      ],
      "default": "btn btn--secondary"
    },
    {
      "type": "checkbox",
      "id": "enable_color_fade",
      "label": "t:general.settings.enable_color_fade.label",
      "info": "t:general.settings.enable_color_fade.info",
      "default": false
    },
    {
      "type": "header",
      "content": "t:general.headers.layout.content"
    },
    {
      "type": "paragraph",
      "content": "t:general.paragraphs.row_size.content"
    },
    {
      "type": "range",
      "id": "layout_row_desktop",
      "min": 1,
      "max": 8,
      "step": 1,
      "label": "t:general.settings.row_desktop.label",
      "default": 5
    },
    {
      "type": "range",
      "id": "layout_row_mobile",
      "min": 1,
      "max": 3,
      "step": 1,
      "label": "t:general.settings.row_mobile.label",
      "default": 2
    },
    {
      "type": "select",
      "id": "filter_placement",
      "label": "t:general.settings.filter_placement.label",
      "options": [
        {
          "value": "top",
          "label": "t:general.settings.filter_placement.top.label"
        },
        {
          "value": "side",
          "label": "t:general.settings.filter_placement.side.label"
        }
      ],
      "default": "top"
    },
    {
      "type": "checkbox",
      "id": "enable_expand_filters",
      "label": "t:general.settings.enable_expand_filters.label",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_margin",
      "label": "t:general.settings.enable_margin.label",
      "default": true
    },
    {
      "type": "header",
      "content": "t:general.headers.display.content"
    },
    {
      "type": "checkbox",
      "id": "enable_sort",
      "label": "t:general.settings.enable_sort.label",
      "default": true
    },
    {
      "type": "checkbox",
      "id": "enable_filter",
      "label": "t:general.settings.enable_filter.label",
      "default": true
    },
    {
      "type": "header",
      "content": "t:general.headers.pagination.content"
    },
    {
      "type": "range",
      "id": "items_per_page",
      "label": "t:general.settings.items_per_page.label",
      "default": 12,
      "min": 1,
      "max": 50,
      "step": 1
    }
  ],
  "presets": [
    {
      "name": "t:sections.search_main.name"
    }
  ],
  "enabled_on": {
    "templates": ["search"]
  }
}
{% endschema %}
